<div class="container">
    <div class="row">
        <div class="col-12">
            <div class="page-header mb-4">
                <h2>
                    <i class="fas fa-list me-2"></i>
                    My Activity
                </h2>
                <p class="text-muted">Track your bidding activity and offers</p>
            </div>

            <!-- Activity Tabs -->
            <ul class="nav nav-tabs mb-4" id="activityTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" 
                            id="bids-tab" 
                            data-bs-toggle="tab" 
                            data-bs-target="#bids" 
                            type="button" 
                            role="tab">
                        <i class="fas fa-gavel me-2"></i>
                        My Bids
                        <span class="badge bg-secondary ms-2">{{ bids.length }}</span>
                    </button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" 
                            id="offers-tab" 
                            data-bs-toggle="tab" 
                            data-bs-target="#offers" 
                            type="button" 
                            role="tab">
                        <i class="fas fa-handshake me-2"></i>
                        My Offers
                        <span class="badge bg-secondary ms-2">{{ offers.length }}</span>
                    </button>
                </li>
            </ul>

            <!-- Tab Content -->
            <div class="tab-content" id="activityTabContent">
                <!-- Bids Tab -->
                <div class="tab-pane fade show active" id="bids" role="tabpanel">
                    <!-- Loading State -->
                    <div class="text-center" *ngIf="loading">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-2">Loading your bids...</p>
                    </div>

                    <!-- Bids List -->
                    <div *ngIf="!loading">
                        <div class="card mb-3" *ngFor="let bid of bids">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-md-3">
                                        <h6 class="mb-1">{{ bid.auction?.title || 'Auction Title' }}</h6>
                                        <small class="text-muted">Bid placed: {{ bid.createdAt | date:'short' }}</small>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="bid-amount">{{ formatPrice(bid.amount) }}</div>
                                        <small class="text-muted">Your bid</small>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="current-price">{{ formatPrice(bid.auction?.currentPrice || 0) }}</div>
                                        <small class="text-muted">Current price</small>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="bid-status">
                                            <span class="badge" [class]="getBidStatusClass(bid)">
                                                {{ getBidStatusText(bid) }}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="col-md-3 text-end">
                                        <button class="btn btn-outline-primary btn-sm"
                                            [routerLink]="['/auctions', bid.auction?.id]">
                                            <i class="fas fa-eye me-1"></i>
                                            View Auction
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- No Bids -->
                        <div class="text-center" *ngIf="bids.length === 0">
                            <div class="empty-state">
                                <i class="fas fa-gavel fa-3x text-muted mb-3"></i>
                                <h4>No bids yet</h4>
                                <p class="text-muted">Start bidding on auctions to see your activity here.</p>
                                <button class="btn btn-primary" routerLink="/auctions">
                                    <i class="fas fa-search me-2"></i>
                                    Browse Auctions
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Offers Tab -->
                <div class="tab-pane fade" id="offers" role="tabpanel">
                    <!-- Loading State -->
                    <div class="text-center" *ngIf="loading">
                        <div class="spinner-border text-primary" role="status">
                            <span class="visually-hidden">Loading...</span>
                        </div>
                        <p class="mt-2">Loading your offers...</p>
                    </div>

                    <!-- Offers List -->
                    <div *ngIf="!loading">
                        <div class="card mb-3" *ngFor="let offer of offers">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col-md-3">
                                        <h6 class="mb-1">{{ offer.auction?.title || 'Direct Sale Title' }}</h6>
                                        <small class="text-muted">Offer made: {{ offer.createdAt | date:'short' }}</small>
                                        @if (offer.message) {
                                        <div class="offer-message mt-1">
                                            <small class="text-muted">"{{ offer.message }}"</small>
                                        </div>
                                        }
                                    </div>
                                    <div class="col-md-2">
                                        <div class="offer-amount">{{ formatPrice(offer.amount) }}</div>
                                        <small class="text-muted">Your offer</small>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="asking-price">{{ formatPrice(offer.auction?.startingPrice || 0) }}</div>
                                        <small class="text-muted">Asking price</small>
                                    </div>
                                    <div class="col-md-2">
                                        <div class="offer-status">
                                            <span class="badge" [class]="getOfferStatusClass(offer)">
                                                {{ getOfferStatusText(offer) }}
                                            </span>
                                        </div>
                                    </div>
                                    <div class="col-md-3 text-end">
                                        <button class="btn btn-outline-primary btn-sm"
                                            [routerLink]="['/auctions', offer.auction?.id]">
                                            <i class="fas fa-eye me-1"></i>
                                            View Sale
                                        </button>
                                        @if (offer.status === 'rejected') {
                                        <button class="btn btn-outline-warning btn-sm ms-2"
                                                (click)="makeNewOffer(offer)">
                                            <i class="fas fa-redo me-1"></i>
                                            New Offer
                                        </button>
                                        }
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- No Offers -->
                        <div class="text-center" *ngIf="offers.length === 0">
                            <div class="empty-state">
                                <i class="fas fa-handshake fa-3x text-muted mb-3"></i>
                                <h4>No offers yet</h4>
                                <p class="text-muted">Make offers on direct sales to see your activity here.</p>
                                <button class="btn btn-primary" routerLink="/auctions">
                                    <i class="fas fa-search me-2"></i>
                                    Browse Sales
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>